!function(e){e.ConditionalFormFields=function(){String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(e,n){var o=n>0?0|n:0;return this.substring(o,o+e.length)===e}}),String.prototype.endsWith||(String.prototype.endsWith=function(e,n){var o=n;return(void 0===o||o>this.length)&&(o=this.length),this.substring(o-e.length,o)===e});var e={ATTACHMENT:"attachment",BIT:"bit",BOOLEAN:"boolean",CHECKBOX:"checkbox",COUNTRY:"country",DATE:"date",DATETIME:"datetime",EMAIL:"email",PHONE:"phone",PICKLIST:"picklist",RADIO:"radio",STATE:"state",STRING:"string",TEXT:"text",TEXTAREA:"textarea",UPLOAD:"upload",URL:"url"},n={CONTAINS:1,DOES_NOT_CONTAIN:2,STARTS_WITH:3,DOES_NOT_START_WITH:4,ENDS_WITH:5,DOES_NOT_END_WITH:6,EMPTY:7,FILLED:8,IS_EQUAL_TO:9,IS_NOT_EQUAL_TO:10};function o(e){return null==e?(console.error("prepOperandForComparison passed null or undefined value"),""):e.toString().toLowerCase()}function r(r,t){var i,a=r.$input;switch(r.fieldDataType){case e.ATTACHMENT:case e.DATE:case e.DATETIME:case e.EMAIL:case e.PHONE:case e.STRING:case e.TEXT:case e.TEXTAREA:case e.UPLOAD:case e.URL:i=a.val();break;case e.COUNTRY:case e.PICKLIST:case e.STATE:i=a.not("[data-hidden]").val();break;case e.BIT:case e.BOOLEAN:case e.CHECKBOX:var c=[],s=a.filter(":checked");$.each(s,function(){c.push($(this).val())}),i=c.join();break;case e.RADIO:i=a.filter(":checked").val();break;default:console.error("processConditionGroup rootNode has unsupported fieldDataType: "+r.fieldDataType)}!function(e,r,t=null){var i=o(e),a=o(t);switch(r){case n.CONTAINS:return i.includes(a);case n.DOES_NOT_CONTAIN:return!i.includes(a);case n.STARTS_WITH:return i.startsWith(a);case n.DOES_NOT_START_WITH:return!i.startsWith(a);case n.ENDS_WITH:return i.endsWith(a);case n.DOES_NOT_END_WITH:return!i.endsWith(a);case n.EMPTY:return""===i;case n.FILLED:return""!==i;case n.IS_EQUAL_TO:return i===a;case n.IS_NOT_EQUAL_TO:return i!==a;default:return console.error("Bad operator passed to evaluateRule: "+r),!1}}(i,t.operator,t.value)?(t.node.fieldDataType!==e.CHECKBOX&&t.node.fieldDataType!==e.RADIO&&(t.node.$input.val(""),t.node.$input.trigger("change")),t.node.$element.hide()):t.node.$element.show()}function t(e,n,o){n.forEach(function(n){r(e,n)}),o(!0)}function i(e){return(1===e.isReferred?"ref_":"field_")+e.fieldID}function a(n){var o={formFieldID:n.id,dataType:n.dataType,fieldID:n.fieldID,isReferred:n.isReferred};return o.$input=$(function(n){var o=i(n);switch(n.dataType){case e.ATTACHMENT:case e.BIT:case e.BOOLEAN:case e.DATE:case e.DATETIME:case e.EMAIL:case e.PHONE:case e.STRING:case e.TEXT:case e.UPLOAD:case e.URL:return'input[name="'+o+'"]';case e.COUNTRY:case e.STATE:return'input[name="'+o+'"], select[data-field-name="'+o+'"]';case e.PICKLIST:return'select[name="'+o+'"]';case e.CHECKBOX:return'input[name="'+o+'[]"]';case e.RADIO:return'input[name="'+o+'"]';case e.TEXTAREA:return'textarea[name="'+o+'"]';default:return console.error("getFieldInputSelector field.dataType not supported: "+n.dataType),""}}(o)),o.$element=$("#"+i(o)),0===o.$input.length&&console.error("No input found for field with formFieldID: "+o.formFieldID),0===o.$element.length&&console.error("No element found for field with formFieldID: "+o.formFieldID),o}function c(e,n){var o=[];return e.forEach(function(e){var r=function(e,n){var o=e,r=n.find(function(n){return n.formFieldID===e.companyFormFieldID});return r?(o.$element=r.$element,o.$input=r.$input,o.fieldDataType=r.dataType,o):(console.log("No field found for node:"),console.log(e),null)}(e,n);null!==r&&o.push(r)}),o}return{init:function(e,n,o){var r,i;if(window.$){if(!e.conditionGroups||!Array.isArray(e.conditionGroups)||0===e.conditionGroups.length)return console.error("FormConditionEvaluator.init() called with bad conditionData.conditionGroups argument."),void console.error(e);if(r=e.conditionGroups,e.formConditionalNodes&&Array.isArray(e.formConditionalNodes)&&0!==e.formConditionalNodes.length)if(i=e.formConditionalNodes,$.isEmptyObject(n))console.error("FormConditionEvaluator.init() called with bad formFields argument.");else{var s=function(e){var n=[];return e.forEach(function(e){n.push(e.companyFormFieldID)}),n}(i),u=c(i,function(e,n){var o=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.includes(e[r].id)&&o.push(a(e[r]));return o}(n,s));r.forEach(function(e){!function(e,n,o){var r=function(e,n){return n.find(function(n){return n.id===e.rootNodeID})}(e,n),i=function(e,n){var o=[];return e&&e.children&&e.children.forEach(function(e){var r=n.find(function(n){return n.id===e.nextNodeIfTrue});e.node=r,o.push(e)}),o}(r,n);if(!r||0===i.length)return console.error("Problem initializing Condition Group:"),console.log("rootNode:"),console.log(r),console.log("children:"),void console.log(i);r.$input.on("keyup",function(){t(r,i,o)}),r.$input.change(function(){t(r,i,o)}),t(r,i,o)}(e,u,o)})}else console.error("FormConditionEvaluator.init() called with bad conditionData.formConditionalNodes argument")}else console.error("jQuery not loaded, FormConditionEvaluator aborting.")}}}}(window);